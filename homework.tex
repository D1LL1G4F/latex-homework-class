\documentclass[11pt]{exam}
\newcommand{\myname}{Matej Kňazík} %Write your name in here
\newcommand{\myUCO}{506481} %write your UCO in here
\newcommand{\myhwtype}{Homework}
\newcommand{\myhwnum}{5} %Homework set number
\newcommand{\myclass}{IV054 2020}
\newcommand{\mylecture}{}
\newcommand{\mysection}{}

% Prefix for numedquestion's
\newcommand{\questiontype}{Question}

% Use this if your "written" questions are all under one section
% For example, if the homework handout has Section 5: Written Questions
% and all questions are 5.1, 5.2, 5.3, etc. set this to 5
% Use for 0 no prefix. Redefine as needed per-question.
\newcommand{\writtensection}{0}

\usepackage{amsmath, amsfonts, amsthm, amssymb}  % Some math symbols
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage[all]{xy}
\usepackage{wrapfig}
\usepackage{fancyvrb}
\usepackage[T1]{fontenc}
\usepackage{listings}

\usepackage{centernot}
\usepackage{mathtools}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclarePairedDelimiter{\card}{\vert}{\vert}


\setlength{\parindent}{0pt}
\setlength{\parskip}{5pt plus 1pt}
\pagestyle{empty}

\def\indented#1{\list{}{}\item[]}
\let\indented=\endlist

\newcounter{questionCounter}
\newcounter{partCounter}[questionCounter]

\newenvironment{namedquestion}[1][\arabic{questionCounter}]{%
    \addtocounter{questionCounter}{1}%
    \setcounter{partCounter}{0}%
    \vspace{.2in}%
        \noindent{\bf #1}%
    \vspace{0.3em} \hrule \vspace{.1in}%
}{}

\newenvironment{numedquestion}[0]{%
	\stepcounter{questionCounter}%
    \vspace{.2in}%
        \ifx\writtensection\undefined
        \noindent{\bf \questiontype \; \arabic{questionCounter}. }%
        \else
          \if\writtensection0
          \noindent{\bf \questiontype \; \arabic{questionCounter}. }%
          \else
          \noindent{\bf \questiontype \; \writtensection.\arabic{questionCounter} }%
        \fi
    \vspace{0.3em} \hrule \vspace{.1in}%
}{}

\newenvironment{alphaparts}[0]{%
  \begin{enumerate}[label=\textbf{(\alph*)}]
}{\end{enumerate}}

\newenvironment{arabicparts}[0]{%
  \begin{enumerate}[label=\textbf{\arabic{questionCounter}.\arabic*})]
}{\end{enumerate}}

\newenvironment{questionpart}[0]{%
  \item
}{}

\newcommand{\answerbox}[1]{
\begin{framed}
\vspace{#1}
\end{framed}}

\pagestyle{head}

\headrule
\header{\textbf{\myclass\ \mylecture\mysection}}%
{\textbf{\myname\ (\myUCO)}}%
{\textbf{\myhwtype\ \myhwnum}}

\begin{document}
\thispagestyle{plain}
\begin{center}
  {\Large \myclass{} \myhwtype{} \myhwnum} \\
  \myname{} (\myUCO{}) \\
  \today
\end{center}


%Here you can enter answers to homework questions

\begin{numedquestion}
  \begin{alphaparts}
    \item
    $w = 506481; e = 11; n = 1147$ \\
    $w_0=506; w_1=481$ \\
    $c_0= w_0^e$ mod $n$ \\
    $c_1= w_1^e$ mod $n$  \\
    $c_0= 670$ \\
    $c_1= 481$ \\
    $c =$ concat $(c_0,c_1)$ \\
    \textbf{encrypted: $c=135675$} \\
    $d = e^{-1} mod (p-1)(q-1)$  \\
    $d = 11^{-1}$ mod  $30 \times 36$ \\
    $d = 11^{-1}$ mod $1080$ \\
    $d = 491$ \\
    $w_0=c_0^d$ mod $ n$ \\
    $w_0=506=670^491$ mod $ 1147$ \\
    $w_1=c_1^d$ mod $ n$ \\
    $w_1=481=481^491$ mod $ 1147$ \\
    $w=$ concat $(w_0,w_1)$ \\
    \textbf{decrypted: $w = 506481$}
    
    \item
    $w = 81 = 1010001_2; m=521; u=131$ \\
    $c = 1010001 \times \{393, 396, 140, 152, 435, 486, 323\}$ \\
    $c = (393 + 140 + 323)$ mod $m$ \\
    $c = 856$ mod $521$ \\
    \textbf{encrypted $c = 335$} \\
    $x=c \times u^{-1}$ mod $ m$ \\
    $x=335 \times 131^{-1}$ mod $521$ \\
    $x = 273$ \\
    \textbf{decrypted: $273$ is mapped on private key $X$ which results in $1010001$}
    
    
    
  \end{alphaparts}
\end{numedquestion}

\begin{numedquestion}
    $65201327 = p \times q; \\
    \phi(65201327)=65185176=(p-1)\times(q-1) \\
    \rightarrow 65201327 = 7933 \times 8219$ \\
    \\
    $134635439 = p \times q; \\
    \phi(134635439)=134610840=(p-1)\times(q-1) \\
    \rightarrow  134635439 = 8219 \times 16381$ \\
    \\
    $122176133 = p \times q; \\
    \phi(122176133)=122152800=(p-1)\times(q-1) \\
    \rightarrow 122176133 = 7933 \times 15401$ \\
    \\
    $122237737 = p \times q; \\
    \phi(122237737)=122214400=(p-1)\times(q-1) \\
    \rightarrow 122237737 = 7937 \times 15401$ \\
    \\
    $99633161 = p \times q; \\
    \phi(99633161)=99612672=(p-1)\times(q-1) \\
    \rightarrow 99633161 = 7937 \times 12553$ \\ 
\end{numedquestion}

%You are given n = 633917, for which you know that it is a product of two primes and
%phi(n) = 632256. Find factors of n without using brute force. Explain your calculations.

\begin{numedquestion}
  $n = 633917 = p \times q$ \\
  $phi(n) = 632256 = (p-1)\times(q-1)$ \\
  $\rightarrow 633917 = 593 \times 1069$ 
\end{numedquestion}

\setcounter{questionCounter}{4}
\begin{numedquestion}
  \begin{alphaparts}
  \item 
    $G'= S \times G \times P$
    \[
    S \times G = 
    \begin{pmatrix}
0 & 1 & 1 & 1 & 0 & 0 & 1 \\
1 & 0 & 1 & 1 & 0 & 1 & 0 \\
0 & 1 & 0 & 1 & 0 & 1 & 0 \\
1 & 1 & 0 & 1 & 1 & 0 & 0
    \end{pmatrix} 
    \]
    \[
    S \times G \times P = G'=
    \begin{pmatrix}
1 & 0 & 1 & 0 & 0 & 1 & 1 \\
1 & 1 & 0 & 0 & 1 & 0 & 1 \\
0 & 0 & 0 & 0 & 1 & 1 & 1 \\
0 & 1 & 0 & 1 & 0 & 1 & 1
    \end{pmatrix}
    \]
    \item
    $w=(1010);e=(0000100)$ \\
    $c=w \times G' + e$ \\
    $c=(1010100) + (0000100)$ \\
    \textbf{encoded: $c=1010000$} \\
    \item
     \[
    P^{-1} =
    \begin{pmatrix}
0 & 0 & 1 & 0 & 0 & 0 & 0 \\
1 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 0 & 1 \\
0 & 0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 0 \\
    \end{pmatrix}
    \]
    $c_1=c \times P^{-1}$ \\
    $c_1=(0010001)$
    \[
    H =
    \begin{pmatrix}
1 & 1 & 0 & 1 & 1 & 0 & 0 \\
1 & 0 & 1 & 1 & 0 & 1 & 0 \\
0 & 1 & 1 & 1 & 0 & 0 & 1 
    \end{pmatrix}
    \]
    syndrome $S(c_1)=(010)$ \\
    $c_0=(0010011)$ \\
    $w_1=(0010)$ \\
    $w=w_1 \times S^{-1}$ \\
    \textbf{decoded: $w=1010$}
  \end{alphaparts}
\end{numedquestion}


% if you do not solve some of the questions use this command to increment counter
% \setcounter{questionCounter}{4}
% \begin{numedquestion}
%   Questions 2 and 3 were not solved, this is an answer to question 5.
% \end{numedquestion}



\end{document}