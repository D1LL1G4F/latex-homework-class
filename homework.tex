\documentclass[11pt]{exam}
\newcommand{\myname}{Matej Kňazík} %Write your name in here
\newcommand{\myUCO}{506481} %write your UCO in here
\newcommand{\myhwtype}{Homework}
\newcommand{\myhwnum}{8} %Homework set number
\newcommand{\myclass}{IV054 2020}
\newcommand{\mylecture}{} 
\newcommand{\mysection}{}

% Prefix for numedquestion's
\newcommand{\questiontype}{Question}

% Use this if your "written" questions are all under one section
% For example, if the homework handout has Section 5: Written Questions
% and all questions are 5.1, 5.2, 5.3, etc. set this to 5
% Use for 0 no prefix. Redefine as needed per-question.
\newcommand{\writtensection}{0}

\usepackage{amsmath, amsfonts, amsthm, amssymb}  % Some math symbols
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage[all]{xy}
\usepackage{wrapfig}
\usepackage{fancyvrb}
\usepackage[T1]{fontenc}
\usepackage{listings}

\usepackage{centernot}
\usepackage{mathtools}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclarePairedDelimiter{\card}{\vert}{\vert}


\setlength{\parindent}{0pt}
\setlength{\parskip}{5pt plus 1pt}
\pagestyle{empty}

\def\indented#1{\list{}{}\item[]}
\let\indented=\endlist

\newcounter{questionCounter}
\newcounter{partCounter}[questionCounter]

\newenvironment{namedquestion}[1][\arabic{questionCounter}]{%
    \addtocounter{questionCounter}{1}%
    \setcounter{partCounter}{0}%
    \vspace{.2in}%
        \noindent{\bf #1}%
    \vspace{0.3em} \hrule \vspace{.1in}%
}{}

\newenvironment{numedquestion}[0]{%
	\stepcounter{questionCounter}%
    \vspace{.2in}%
        \ifx\writtensection\undefined
        \noindent{\bf \questiontype \; \arabic{questionCounter}. }%
        \else
          \if\writtensection0
          \noindent{\bf \questiontype \; \arabic{questionCounter}. }%
          \else
          \noindent{\bf \questiontype \; \writtensection.\arabic{questionCounter} }%
        \fi
    \vspace{0.3em} \hrule \vspace{.1in}%
}{}

\newenvironment{alphaparts}[0]{%
  \begin{enumerate}[label=\textbf{(\alph*)}]
}{\end{enumerate}}

\newenvironment{arabicparts}[0]{%
  \begin{enumerate}[label=\textbf{\arabic{questionCounter}.\arabic*})]
}{\end{enumerate}}

\newenvironment{questionpart}[0]{%
  \item
}{}

\newcommand{\answerbox}[1]{
\begin{framed}
\vspace{#1}
\end{framed}}

\pagestyle{head}

\headrule
\header{\textbf{\myclass\ \mylecture\mysection}}%
{\textbf{\myname\ (\myUCO)}}%
{\textbf{\myhwtype\ \myhwnum}}

\begin{document}
\thispagestyle{plain}
\begin{center}
  {\Large \myclass{} \myhwtype{} \myhwnum} \\
  \myname{} (\myUCO{}) \\
  \today
\end{center}


%Here you can enter answers to homework questions

\begin{numedquestion}
\begin{alphaparts}
    \item 
    $h(x) = 5^x \mod 1033 $ \\
    $h(506581) = 5^506581 \mod 1033$ \\
    \textbf{hash: }$h(506581) = 232$
    \item
    $E: y^2  = x^3 + 3x + 983 \mod 997$ \\
    $P=(325,345)$ \\
    $Q = xP = (a_1,a_2)$ \\
    $Q = xP = (879,211)$ \\
    $x = 140$ \\
    $r = 339$ \\
    $k = 1034$ \\
    $s = r^{-1} \times (h(x) - a_1 \times x) \mod k$ \\
    $r^-1 = 973$ \\
    $s = 973 \times (232 - 879 \times 140) \mod 1034$ \\
    \textbf{signature: }$s = 144$ \\
\end{alphaparts}
\end{numedquestion}
    
\begin{numedquestion}
\begin{alphaparts}
    \item
    Using elliptic curve point addition law and multiplicative inverses I've checked all combinations of $0\leq a \leq6$ and $0\leq b \leq 6$ for $y^2 = x^3+ax+b \mod 7$ \\
    
    elliptic curve over $\mathbb{F}_7$ could have minimum 4 points (including point at infinity) and maximum 12 points (including point at infinity) \\
    
    examples: \\
    elliptic curve with the minimal number of points: $E_{min} = y^2 = x^3+6 \mod 7$ \\
    points: $(\infty),(1,0),(2,0),(4,0)$ \\
    elliptic curve with the maximal number of points: $E_{max} = y^2 = x^3+6x+1 \mod 7$ \\
    points: $(\infty),(0,1),(0.6),(1,1),(1,6),(2,0),(3,2),(3,5),(5,3),(5,4),(6,1),(6,6)$
     
    \item
    $E_{1} = y^2 = x^3+3x+2 \mod 7$ \\
    $P_{e1} = \{(\infty),(0,3),(0,4),(2,3),(2.4),(4,1),(4,6),(5,3),(5,4)\}$ \\
    $E_{2} = y^2 = x^3+5x+2 \mod 7$ \\
    $P_{e2} = \{(\infty),(0,3),(0,4),(1,1),(1.6),(3,3),(3,4),(4,3),(4,4)\}$ \\
    $P_{e1} \neq P_{e2}$
\end{alphaparts}
\end{numedquestion}


\setcounter{questionCounter}{3}
\begin{numedquestion}
$N = 1927$ \\
$a = f(1927) = 2^{1927} \mod 1927$ \\
$a = 1153$ \\
since $r = 460$ is even then \\
$(a^{\frac{r}{2}} -1) \times (a^{\frac{r}{2}} +1)$ is divisible by $N$ \\
since $(a^{\frac{r}{2}} -1)$ is not divisible by $N$ \\
and also $(a^{\frac{r}{2}} +1)$ is not divisible by $N$ \\
then $(a^{\frac{r}{2}} -1) \times (a^{\frac{r}{2}} +1)$ must be divisible by both $p$ and $q$\\
therefore $p = \gcd(N,a^{\frac{r}{2}} -1)$ and $q = \gcd(N,a^{\frac{r}{2}} +1)$ \\
$p = \gcd(1153^{230} - 1,1927)$ \\
$q = \gcd(1153^{230} + 1,1927)$ \\
$p = 47$ \\
$q = 41$ \\
\textbf{factorization: }$1927 = 47 \times 41$
\end{numedquestion}

\begin{numedquestion}
I used Point addition to recursively determine all possible points. \\
$P + Q = R$ \\
$(x_p,y_p) + (x_q,y_q) = (x_r,y_r)$ \\
$\lambda = \frac{y_q-y_p}{x_q - x_p}$ \\
$x_r = \lambda^2 - x_p - x_q$ \\
$y_r = \lambda \times (x_p - x_r ) - y_p$ \\
Number of points of elliptic curve $E: y^2=x_3+3x+7 \pmod{113}$ is \textbf{126} (including the point at infinity).
\end{numedquestion}


% if you do not solve some of the questions use this command to increment counter
% \setcounter{questionCounter}{4}
% \begin{numedquestion}
%   Questions 2 and 3 were not solved, this is an answer to question 5.
% \end{numedquestion}



\end{document}